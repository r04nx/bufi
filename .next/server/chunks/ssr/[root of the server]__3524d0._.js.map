{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/rohan/Public/bufi/app/%28login%29/login.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const Login = registerClientReference(\n    function() { throw new Error(\"Attempted to call Login() from the server but Login is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/(login)/login.tsx <module evaluation>\",\n    \"Login\",\n);\n"],"names":[],"mappings":";;;AAAA;;AACO,MAAM,QAAQ,CAAA,GAAA,oYAAA,CAAA,0BAAuB,AAAD,EACvC;IAAa,MAAM,IAAI,MAAM;AAA0N,GACvP,uDACA"}},
    {"offset": {"line": 15, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["file:///home/rohan/Public/bufi/app/%28login%29/login.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const Login = registerClientReference(\n    function() { throw new Error(\"Attempted to call Login() from the server but Login is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/(login)/login.tsx\",\n    \"Login\",\n);\n"],"names":[],"mappings":";;;AAAA;;AACO,MAAM,QAAQ,CAAA,GAAA,oYAAA,CAAA,0BAAuB,AAAD,EACvC;IAAa,MAAM,IAAI,MAAM;AAA0N,GACvP,mCACA"}},
    {"offset": {"line": 29, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 35, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 39, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 45, "column": 0}, "map": {"version":3,"sources":["file:///home/rohan/Public/bufi/app/%28login%29/sign-in/page.tsx"],"sourcesContent":["import { Suspense } from 'react';\nimport { Login } from '../login';\n\nexport default function SignInPage() {\n  return (\n    <Suspense>\n      <Login mode=\"signin\" />\n    </Suspense>\n  );\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;;AAEe,SAAS;IACtB,qBACE,6XAAC,oVAAA,CAAA,WAAQ;kBACP,cAAA,6XAAC,0HAAA,CAAA,QAAK;YAAC,MAAK;;;;;;;;;;;AAGlB"}},
    {"offset": {"line": 69, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 121, "column": 0}, "map": {"version":3,"sources":["file:///home/rohan/Public/bufi/lib/payments/stripe.ts"],"sourcesContent":["import Stripe from 'stripe';\nimport { redirect } from 'next/navigation';\nimport { Team } from '@/lib/db/schema';\nimport {\n  getTeamByStripeCustomerId,\n  getUser,\n  updateTeamSubscription\n} from '@/lib/db/queries';\n\nexport const stripe = new Stripe(process.env.STRIPE_SECRET_KEY!, {\n  apiVersion: '2025-01-27.acacia'\n});\n\nexport async function createCheckoutSession({\n  team,\n  priceId\n}: {\n  team: Team | null;\n  priceId: string;\n}) {\n  const user = await getUser();\n\n  if (!team || !user) {\n    redirect(`/sign-up?redirect=checkout&priceId=${priceId}`);\n  }\n\n  const session = await stripe.checkout.sessions.create({\n    payment_method_types: ['card'],\n    line_items: [\n      {\n        price: priceId,\n        quantity: 1\n      }\n    ],\n    mode: 'subscription',\n    success_url: `${process.env.BASE_URL}/api/stripe/checkout?session_id={CHECKOUT_SESSION_ID}`,\n    cancel_url: `${process.env.BASE_URL}/pricing`,\n    customer: team.stripeCustomerId || undefined,\n    client_reference_id: user.id.toString(),\n    allow_promotion_codes: true,\n    subscription_data: {\n      trial_period_days: 14\n    }\n  });\n\n  redirect(session.url!);\n}\n\nexport async function createCustomerPortalSession(team: Team) {\n  if (!team.stripeCustomerId || !team.stripeProductId) {\n    redirect('/pricing');\n  }\n\n  let configuration: Stripe.BillingPortal.Configuration;\n  const configurations = await stripe.billingPortal.configurations.list();\n\n  if (configurations.data.length > 0) {\n    configuration = configurations.data[0];\n  } else {\n    const product = await stripe.products.retrieve(team.stripeProductId);\n    if (!product.active) {\n      throw new Error(\"Team's product is not active in Stripe\");\n    }\n\n    const prices = await stripe.prices.list({\n      product: product.id,\n      active: true\n    });\n    if (prices.data.length === 0) {\n      throw new Error(\"No active prices found for the team's product\");\n    }\n\n    configuration = await stripe.billingPortal.configurations.create({\n      business_profile: {\n        headline: 'Manage your subscription'\n      },\n      features: {\n        subscription_update: {\n          enabled: true,\n          default_allowed_updates: ['price', 'quantity', 'promotion_code'],\n          proration_behavior: 'create_prorations',\n          products: [\n            {\n              product: product.id,\n              prices: prices.data.map((price) => price.id)\n            }\n          ]\n        },\n        subscription_cancel: {\n          enabled: true,\n          mode: 'at_period_end',\n          cancellation_reason: {\n            enabled: true,\n            options: [\n              'too_expensive',\n              'missing_features',\n              'switched_service',\n              'unused',\n              'other'\n            ]\n          }\n        }\n      }\n    });\n  }\n\n  return stripe.billingPortal.sessions.create({\n    customer: team.stripeCustomerId,\n    return_url: `${process.env.BASE_URL}/dashboard`,\n    configuration: configuration.id\n  });\n}\n\nexport async function handleSubscriptionChange(\n  subscription: Stripe.Subscription\n) {\n  const customerId = subscription.customer as string;\n  const subscriptionId = subscription.id;\n  const status = subscription.status;\n\n  const team = await getTeamByStripeCustomerId(customerId);\n\n  if (!team) {\n    console.error('Team not found for Stripe customer:', customerId);\n    return;\n  }\n\n  if (status === 'active' || status === 'trialing') {\n    const plan = subscription.items.data[0]?.plan;\n    await updateTeamSubscription(team.id, {\n      stripeSubscriptionId: subscriptionId,\n      stripeProductId: plan?.product as string,\n      planName: (plan?.product as Stripe.Product).name,\n      subscriptionStatus: status\n    });\n  } else if (status === 'canceled' || status === 'unpaid') {\n    await updateTeamSubscription(team.id, {\n      stripeSubscriptionId: null,\n      stripeProductId: null,\n      planName: null,\n      subscriptionStatus: status\n    });\n  }\n}\n\nexport async function getStripePrices() {\n  const prices = await stripe.prices.list({\n    expand: ['data.product'],\n    active: true,\n    type: 'recurring'\n  });\n\n  return prices.data.map((price) => ({\n    id: price.id,\n    productId:\n      typeof price.product === 'string' ? price.product : price.product.id,\n    unitAmount: price.unit_amount,\n    currency: price.currency,\n    interval: price.recurring?.interval,\n    trialPeriodDays: price.recurring?.trial_period_days\n  }));\n}\n\nexport async function getStripeProducts() {\n  const products = await stripe.products.list({\n    active: true,\n    expand: ['data.default_price']\n  });\n\n  return products.data.map((product) => ({\n    id: product.id,\n    name: product.name,\n    description: product.description,\n    defaultPriceId:\n      typeof product.default_price === 'string'\n        ? product.default_price\n        : product.default_price?.id\n  }));\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 286, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 292, "column": 0}, "map": {"version":3,"sources":["file:///home/rohan/Public/bufi/lib/auth/middleware.ts"],"sourcesContent":["import { z } from 'zod';\nimport { TeamDataWithMembers, User } from '@/lib/db/schema';\nimport { getTeamForUser, getUser } from '@/lib/db/queries';\nimport { redirect } from 'next/navigation';\n\nexport type ActionState = {\n  error?: string;\n  success?: string;\n  [key: string]: any; // This allows for additional properties\n};\n\ntype ValidatedActionFunction<S extends z.ZodType<any, any>, T> = (\n  data: z.infer<S>,\n  formData: FormData\n) => Promise<T>;\n\nexport function validatedAction<S extends z.ZodType<any, any>, T>(\n  schema: S,\n  action: ValidatedActionFunction<S, T>\n) {\n  return async (prevState: ActionState, formData: FormData): Promise<T> => {\n    const result = schema.safeParse(Object.fromEntries(formData));\n    if (!result.success) {\n      return { error: result.error.errors[0].message } as T;\n    }\n\n    return action(result.data, formData);\n  };\n}\n\ntype ValidatedActionWithUserFunction<S extends z.ZodType<any, any>, T> = (\n  data: z.infer<S>,\n  formData: FormData,\n  user: User\n) => Promise<T>;\n\nexport function validatedActionWithUser<S extends z.ZodType<any, any>, T>(\n  schema: S,\n  action: ValidatedActionWithUserFunction<S, T>\n) {\n  return async (prevState: ActionState, formData: FormData): Promise<T> => {\n    const user = await getUser();\n    if (!user) {\n      throw new Error('User is not authenticated');\n    }\n\n    const result = schema.safeParse(Object.fromEntries(formData));\n    if (!result.success) {\n      return { error: result.error.errors[0].message } as T;\n    }\n\n    return action(result.data, formData, user);\n  };\n}\n\ntype ActionWithTeamFunction<T> = (\n  formData: FormData,\n  team: TeamDataWithMembers\n) => Promise<T>;\n\nexport function withTeam<T>(action: ActionWithTeamFunction<T>) {\n  return async (formData: FormData): Promise<T> => {\n    const user = await getUser();\n    if (!user) {\n      redirect('/sign-in');\n    }\n\n    const team = await getTeamForUser(user.id);\n    if (!team) {\n      throw new Error('Team not found');\n    }\n\n    return action(formData, team);\n  };\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;;;AAaO,SAAS,gBACd,MAAS,EACT,MAAqC;IAErC,OAAO,OAAO,WAAwB;QACpC,MAAM,SAAS,OAAO,SAAS,CAAC,OAAO,WAAW,CAAC;QACnD,IAAI,CAAC,OAAO,OAAO,EAAE;YACnB,OAAO;gBAAE,OAAO,OAAO,KAAK,CAAC,MAAM,CAAC,EAAE,CAAC,OAAO;YAAC;QACjD;QAEA,OAAO,OAAO,OAAO,IAAI,EAAE;IAC7B;AACF;AAQO,SAAS,wBACd,MAAS,EACT,MAA6C;IAE7C,OAAO,OAAO,WAAwB;QACpC,MAAM,OAAO,MAAM,CAAA,GAAA,oHAAA,CAAA,UAAO,AAAD;QACzB,IAAI,CAAC,MAAM;YACT,MAAM,IAAI,MAAM;QAClB;QAEA,MAAM,SAAS,OAAO,SAAS,CAAC,OAAO,WAAW,CAAC;QACnD,IAAI,CAAC,OAAO,OAAO,EAAE;YACnB,OAAO;gBAAE,OAAO,OAAO,KAAK,CAAC,MAAM,CAAC,EAAE,CAAC,OAAO;YAAC;QACjD;QAEA,OAAO,OAAO,OAAO,IAAI,EAAE,UAAU;IACvC;AACF;AAOO,SAAS,SAAY,MAAiC;IAC3D,OAAO,OAAO;QACZ,MAAM,OAAO,MAAM,CAAA,GAAA,oHAAA,CAAA,UAAO,AAAD;QACzB,IAAI,CAAC,MAAM;YACT,CAAA,GAAA,oUAAA,CAAA,WAAQ,AAAD,EAAE;QACX;QAEA,MAAM,OAAO,MAAM,CAAA,GAAA,oHAAA,CAAA,iBAAc,AAAD,EAAE,KAAK,EAAE;QACzC,IAAI,CAAC,MAAM;YACT,MAAM,IAAI,MAAM;QAClB;QAEA,OAAO,OAAO,UAAU;IAC1B;AACF"}},
    {"offset": {"line": 341, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 347, "column": 0}, "map": {"version":3,"sources":["file:///home/rohan/Public/bufi/app/%28login%29/actions.ts"],"sourcesContent":["'use server';\n\nimport { z } from 'zod';\nimport { and, eq, sql } from 'drizzle-orm';\nimport { db } from '@/lib/db/drizzle';\nimport {\n  User,\n  users,\n  teams,\n  teamMembers,\n  activityLogs,\n  type NewUser,\n  type NewTeam,\n  type NewTeamMember,\n  type NewActivityLog,\n  ActivityType,\n  invitations,\n} from '@/lib/db/schema';\nimport { comparePasswords, hashPassword, setSession } from '@/lib/auth/session';\nimport { redirect } from 'next/navigation';\nimport { cookies } from 'next/headers';\nimport { createCheckoutSession } from '@/lib/payments/stripe';\nimport { getUser, getUserWithTeam } from '@/lib/db/queries';\nimport {\n  validatedAction,\n  validatedActionWithUser,\n} from '@/lib/auth/middleware';\n\nasync function logActivity(\n  teamId: number | null | undefined,\n  userId: number,\n  type: ActivityType,\n  ipAddress?: string,\n) {\n  if (teamId === null || teamId === undefined) {\n    return;\n  }\n  const newActivity: NewActivityLog = {\n    teamId,\n    userId,\n    action: type,\n    ipAddress: ipAddress || '',\n  };\n  await db.insert(activityLogs).values(newActivity);\n}\n\nconst signInSchema = z.object({\n  email: z.string().email().min(3).max(255),\n  password: z.string().min(8).max(100),\n});\n\nexport const signIn = validatedAction(signInSchema, async (data, formData) => {\n  const { email, password } = data;\n\n  const userWithTeam = await db\n    .select({\n      user: users,\n      team: teams,\n    })\n    .from(users)\n    .leftJoin(teamMembers, eq(users.id, teamMembers.userId))\n    .leftJoin(teams, eq(teamMembers.teamId, teams.id))\n    .where(eq(users.email, email))\n    .limit(1);\n\n  if (userWithTeam.length === 0) {\n    return {\n      error: 'Invalid email or password. Please try again.',\n      email,\n      password,\n    };\n  }\n\n  const { user: foundUser, team: foundTeam } = userWithTeam[0];\n\n  const isPasswordValid = await comparePasswords(\n    password,\n    foundUser.passwordHash,\n  );\n\n  if (!isPasswordValid) {\n    return {\n      error: 'Invalid email or password. Please try again.',\n      email,\n      password,\n    };\n  }\n\n  await Promise.all([\n    setSession(foundUser),\n    logActivity(foundTeam?.id, foundUser.id, ActivityType.SIGN_IN),\n  ]);\n\n  const redirectTo = formData.get('redirect') as string | null;\n  if (redirectTo === 'checkout') {\n    const priceId = formData.get('priceId') as string;\n    return createCheckoutSession({ team: foundTeam, priceId });\n  }\n\n  redirect('/dashboard');\n});\n\nconst signUpSchema = z.object({\n  email: z.string().email(),\n  password: z.string().min(8),\n  inviteId: z.string().optional(),\n});\n\nexport const signUp = validatedAction(signUpSchema, async (data, formData) => {\n  const { email, password, inviteId } = data;\n\n  const existingUser = await db\n    .select()\n    .from(users)\n    .where(eq(users.email, email))\n    .limit(1);\n\n  if (existingUser.length > 0) {\n    return {\n      error: 'Failed to create user. Please try again.',\n      email,\n      password,\n    };\n  }\n\n  const passwordHash = await hashPassword(password);\n\n  const newUser: NewUser = {\n    email,\n    passwordHash,\n    role: 'owner', // Default role, will be overridden if there's an invitation\n  };\n\n  const [createdUser] = await db.insert(users).values(newUser).returning();\n\n  if (!createdUser) {\n    return {\n      error: 'Failed to create user. Please try again.',\n      email,\n      password,\n    };\n  }\n\n  let teamId: number;\n  let userRole: string;\n  let createdTeam: typeof teams.$inferSelect | null = null;\n\n  if (inviteId) {\n    // Check if there's a valid invitation\n    const [invitation] = await db\n      .select()\n      .from(invitations)\n      .where(\n        and(\n          eq(invitations.id, parseInt(inviteId)),\n          eq(invitations.email, email),\n          eq(invitations.status, 'pending'),\n        ),\n      )\n      .limit(1);\n\n    if (invitation) {\n      teamId = invitation.teamId;\n      userRole = invitation.role;\n\n      await db\n        .update(invitations)\n        .set({ status: 'accepted' })\n        .where(eq(invitations.id, invitation.id));\n\n      await logActivity(teamId, createdUser.id, ActivityType.ACCEPT_INVITATION);\n\n      [createdTeam] = await db\n        .select()\n        .from(teams)\n        .where(eq(teams.id, teamId))\n        .limit(1);\n    } else {\n      return { error: 'Invalid or expired invitation.', email, password };\n    }\n  } else {\n    // Create a new team if there's no invitation\n    const newTeam: NewTeam = {\n      name: `${email}'s Team`,\n    };\n\n    [createdTeam] = await db.insert(teams).values(newTeam).returning();\n\n    if (!createdTeam) {\n      return {\n        error: 'Failed to create team. Please try again.',\n        email,\n        password,\n      };\n    }\n\n    teamId = createdTeam.id;\n    userRole = 'owner';\n\n    await logActivity(teamId, createdUser.id, ActivityType.CREATE_TEAM);\n  }\n\n  const newTeamMember: NewTeamMember = {\n    userId: createdUser.id,\n    teamId: teamId,\n    role: userRole,\n  };\n\n  await Promise.all([\n    db.insert(teamMembers).values(newTeamMember),\n    logActivity(teamId, createdUser.id, ActivityType.SIGN_UP),\n    setSession(createdUser),\n  ]);\n\n  const redirectTo = formData.get('redirect') as string | null;\n  if (redirectTo === 'checkout') {\n    const priceId = formData.get('priceId') as string;\n    return createCheckoutSession({ team: createdTeam, priceId });\n  }\n\n  redirect('/dashboard');\n});\n\nexport async function signOut() {\n  const user = (await getUser()) as User;\n  const userWithTeam = await getUserWithTeam(user.id);\n  await logActivity(userWithTeam?.teamId, user.id, ActivityType.SIGN_OUT);\n  (await cookies()).delete('session');\n}\n\nconst updatePasswordSchema = z\n  .object({\n    currentPassword: z.string().min(8).max(100),\n    newPassword: z.string().min(8).max(100),\n    confirmPassword: z.string().min(8).max(100),\n  })\n  .refine((data) => data.newPassword === data.confirmPassword, {\n    message: \"Passwords don't match\",\n    path: ['confirmPassword'],\n  });\n\nexport const updatePassword = validatedActionWithUser(\n  updatePasswordSchema,\n  async (data, _, user) => {\n    const { currentPassword, newPassword } = data;\n\n    const isPasswordValid = await comparePasswords(\n      currentPassword,\n      user.passwordHash,\n    );\n\n    if (!isPasswordValid) {\n      return { error: 'Current password is incorrect.' };\n    }\n\n    if (currentPassword === newPassword) {\n      return {\n        error: 'New password must be different from the current password.',\n      };\n    }\n\n    const newPasswordHash = await hashPassword(newPassword);\n    const userWithTeam = await getUserWithTeam(user.id);\n\n    await Promise.all([\n      db\n        .update(users)\n        .set({ passwordHash: newPasswordHash })\n        .where(eq(users.id, user.id)),\n      logActivity(userWithTeam?.teamId, user.id, ActivityType.UPDATE_PASSWORD),\n    ]);\n\n    return { success: 'Password updated successfully.' };\n  },\n);\n\nconst deleteAccountSchema = z.object({\n  password: z.string().min(8).max(100),\n});\n\nexport const deleteAccount = validatedActionWithUser(\n  deleteAccountSchema,\n  async (data, _, user) => {\n    const { password } = data;\n\n    const isPasswordValid = await comparePasswords(password, user.passwordHash);\n    if (!isPasswordValid) {\n      return { error: 'Incorrect password. Account deletion failed.' };\n    }\n\n    const userWithTeam = await getUserWithTeam(user.id);\n\n    await logActivity(\n      userWithTeam?.teamId,\n      user.id,\n      ActivityType.DELETE_ACCOUNT,\n    );\n\n    // Soft delete\n    await db\n      .update(users)\n      .set({\n        deletedAt: sql`CURRENT_TIMESTAMP`,\n        email: sql`CONCAT(email, '-', id, '-deleted')`, // Ensure email uniqueness\n      })\n      .where(eq(users.id, user.id));\n\n    if (userWithTeam?.teamId) {\n      await db\n        .delete(teamMembers)\n        .where(\n          and(\n            eq(teamMembers.userId, user.id),\n            eq(teamMembers.teamId, userWithTeam.teamId),\n          ),\n        );\n    }\n\n    (await cookies()).delete('session');\n    redirect('/sign-in');\n  },\n);\n\nconst updateAccountSchema = z.object({\n  name: z.string().min(1, 'Name is required').max(100),\n  email: z.string().email('Invalid email address'),\n});\n\nexport const updateAccount = validatedActionWithUser(\n  updateAccountSchema,\n  async (data, _, user) => {\n    const { name, email } = data;\n    const userWithTeam = await getUserWithTeam(user.id);\n\n    await Promise.all([\n      db.update(users).set({ name, email }).where(eq(users.id, user.id)),\n      logActivity(userWithTeam?.teamId, user.id, ActivityType.UPDATE_ACCOUNT),\n    ]);\n\n    return { success: 'Account updated successfully.' };\n  },\n);\n\nconst removeTeamMemberSchema = z.object({\n  memberId: z.number(),\n});\n\nexport const removeTeamMember = validatedActionWithUser(\n  removeTeamMemberSchema,\n  async (data, _, user) => {\n    const { memberId } = data;\n    const userWithTeam = await getUserWithTeam(user.id);\n\n    if (!userWithTeam?.teamId) {\n      return { error: 'User is not part of a team' };\n    }\n\n    await db\n      .delete(teamMembers)\n      .where(\n        and(\n          eq(teamMembers.id, memberId),\n          eq(teamMembers.teamId, userWithTeam.teamId),\n        ),\n      );\n\n    await logActivity(\n      userWithTeam.teamId,\n      user.id,\n      ActivityType.REMOVE_TEAM_MEMBER,\n    );\n\n    return { success: 'Team member removed successfully' };\n  },\n);\n\nconst inviteTeamMemberSchema = z.object({\n  email: z.string().email('Invalid email address'),\n  role: z.enum(['member', 'owner']),\n});\n\nexport const inviteTeamMember = validatedActionWithUser(\n  inviteTeamMemberSchema,\n  async (data, _, user) => {\n    const { email, role } = data;\n    const userWithTeam = await getUserWithTeam(user.id);\n\n    if (!userWithTeam?.teamId) {\n      return { error: 'User is not part of a team' };\n    }\n\n    const existingMember = await db\n      .select()\n      .from(users)\n      .leftJoin(teamMembers, eq(users.id, teamMembers.userId))\n      .where(\n        and(\n          eq(users.email, email),\n          eq(teamMembers.teamId, userWithTeam.teamId),\n        ),\n      )\n      .limit(1);\n\n    if (existingMember.length > 0) {\n      return { error: 'User is already a member of this team' };\n    }\n\n    // Check if there's an existing invitation\n    const existingInvitation = await db\n      .select()\n      .from(invitations)\n      .where(\n        and(\n          eq(invitations.email, email),\n          eq(invitations.teamId, userWithTeam.teamId),\n          eq(invitations.status, 'pending'),\n        ),\n      )\n      .limit(1);\n\n    if (existingInvitation.length > 0) {\n      return { error: 'An invitation has already been sent to this email' };\n    }\n\n    // Create a new invitation\n    await db.insert(invitations).values({\n      teamId: userWithTeam.teamId,\n      email,\n      role,\n      invitedBy: user.id,\n      status: 'pending',\n    });\n\n    await logActivity(\n      userWithTeam.teamId,\n      user.id,\n      ActivityType.INVITE_TEAM_MEMBER,\n    );\n\n    // TODO: Send invitation email and include ?inviteId={id} to sign-up URL\n    // await sendInvitationEmail(email, userWithTeam.team.name, role)\n\n    return { success: 'Invitation sent successfully' };\n  },\n);\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 685, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 691, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 700, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}